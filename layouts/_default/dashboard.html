<!DOCTYPE html>
<html lang="en">
  {{ partial "head.html" . }}
  <body class="nk-body body-wider theme-dark mode-onepage">
    <div class="nk-wrap">
      <!-- Header -->
      {{ partial "navbar.html" . }}

      <!-- Main Content -->
      <main class="nk-pages">
        <div class="container">
          <h1 class="title title-xl tc-light">Welcome to your Dashboard</h1>
          <h3 id="user-name" class="subtitle tc-light">Hello, User</h3>

          <!-- Dashboard Content -->
          <div class="dashboard-content">
            <p>This is your dashboard where you can manage your account, view your data, and more.</p>
          </div>
        </div>
        <!-- Particles Background -->
        <div id="particles-bg" class="particles-container particles-bg" 
             data-pt-base="#a83232" 
             data-pt-base-op=".7" 
             data-pt-line="#b84545" 
             data-pt-line-op=".7" 
             data-pt-shape="#8b1f1f" 
             data-pt-shape-op=".5">
        </div>
      </main>

      <!-- Footer -->
      {{ partial "footer.html" . }}

      <!-- Scripts -->
      {{ partial "javascript.html" . }}

      <!-- Netlify Identity Script -->
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          if (window.netlifyIdentity) {
            initNetlifyIdentity();
          } else {
            document.addEventListener('netlifyIdentityWidgetReady', initNetlifyIdentity);
          }

          function initNetlifyIdentity() {
            // Check the current user status
            window.netlifyIdentity.on("init", user => {
              updateUserName(user);
            });

            // When the user logs in
            window.netlifyIdentity.on("login", user => {
              updateUserName(user);
            });

            // Update the user's name on the dashboard
            function updateUserName(user) {
              const userNameElement = document.getElementById('user-name');
              if (user && user.user_metadata) {
                userNameElement.innerHTML = `Hello, ${user.user_metadata.full_name}`;
              } else {
                userNameElement.innerHTML = "Hello, Guest";
              }
            }
          }
        });
      </script>
    </div>
  </body>
</html>
