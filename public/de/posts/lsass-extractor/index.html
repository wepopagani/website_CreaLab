<!DOCTYPE html>
<html lang="zxx" class="js"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="author" content="Softnio">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    
    <link rel="shortcut icon" href="/images/favicon.png">
    
    <title>TeamFence</title>
    
    
    
    
    
    
    <link rel="stylesheet" href='/css/vendor.bundle.min.css?ver=210'>
    <link rel="stylesheet" href='/css/style-lungwort.min.css?ver=210'>
    
    <link rel="stylesheet" href='/css/theme.min.css?ver=210'>
    <link rel="stylesheet" href='/css/custom.min.css?ver=210'>
</head>
<body class="nk-body body-wider theme-light mode-onepage"> 
<div class="nk-wrap">
    <header class="nk-header page-header is-transparent is-sticky is-shrink is-dark" id="header"> 
        <div class="header-main">
    <div class="header-container container">
        <div class="header-wrap">
            
            <div class="header-logo logo animated" data-animate="fadeInDown" data-delay=".65">
                <a href="/" class="logo-link">
                    <img class="logo-dark" src="/images/logo.png" srcset="/images/logo.png" alt="logo">
                    <img class="logo-light" src="/images/logo-white.png" srcset="/images/logo-white.png" alt="logo">
                </a>
            </div>
            
            <div class="header-nav-toggle">
                <a href="/" class="navbar-toggle" data-menu-toggle="example-menu-04">
                    <div class="toggle-line">
                        <span></span>
                    </div>
                </a>
            </div>
            
            <div class="header-navbar header-navbar-s1">
                <nav class="header-menu" id="example-menu-04">
                    <ul class="menu menu-s2 animated" data-animate="fadeInDown" data-delay=".75">
                        
                        <li class="menu-item">
                            <a class="menu-link nav-link" href="/de/">Startseite</a>
                        </li>
                        
                        <li class="menu-item">
                            <a class="menu-link nav-link" href="/de/#services">Dienstleistungen</a>
                        </li>
                        
                        <li class="menu-item">
                            <a class="menu-link nav-link" href="/de/#about">Unternehmen</a>
                        </li>
                        
                        <li class="menu-item">
                            <a class="menu-link nav-link" href="/de/posts/">Blog</a>
                        </li>
                        
                        <li class="menu-item">
                            <a class="menu-link nav-link" href="/de/about/">Über uns</a>
                        </li>
                        
                    </ul>
                    <ul class="menu-btns animated" data-animate="fadeInDown" data-delay=".85">
                        
                        <li><a href="#contact" class="btn btn-rg btn-auto btn-outline btn-grad on-bg-theme btn-round">
                            <span>Kontaktieren Sie uns</span></a>
                        </li>
                        
                        <li class="menu-item">
                            <select id="select-language" onchange="location = this.value;">
                                
                                
                                
                                
                                
                                
                                
                                
                                <option id="en" value="http://localhost:1313/posts/lsass-extractor/">English</option>
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                <option id="de" value="http://localhost:1313/de/posts/lsass-extractor/" selected>Deutsch
                                </option>
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                <option id="it" value="http://localhost:1313/it/posts/lsass-extractor/">Italiano</option>
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                <option id="fr" value="http://localhost:1313/fr/posts/lsass-extractor/">Français</option>
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                <option id="es" value="http://localhost:1313/es/posts/lsass-extractor/">Español</option>
                                
                                
                                
                                
                            </select>
                            
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
</div>

        <div class="header-banner bg-purple"> 
            <div class="nk-ovm shape-a-sm"></div>
        </div>
        
    </header>
    <main class="nk-pages">
        <section class="section bg-light">
            <div class="container" style="margin-top: -50px">
                <div class="nk-block nk-block-blog">
                    <div class="row">
                        <div class="col-12">
                            <div class="blog-details">
                                <div class="row justify-content-center">
                                    <div class="col-xl-8 col-lg-10">
                                        <ul class="blog-meta">
                                            <li><a href="#">September 16, 2023</a></li>
                                            <li><a href="#">8  minutes  read</a></li>
                                        </ul>
                                        <div class="blog-content">
                                            <h2 class="title"><a href="#">Lsass-Extraktor</a></h2>
                                            <div class="col-xl-10 col-lg-12">
                                                <div class="blog-featured">
                                                    <div class="img-wrapper-single">
                                                        <div class="box box1" id="img-container">
                                                            <img class="round post-image" src="/posts/lsass-extractor/static/cover.png" alt="featured">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div> 
                                                <h2 id="einführung">Einführung</h2>
<p>Bei TeamFence sind wir fest davon überzeugt, dass es für einen Offensiv-Operator heutzutage immer wichtiger ist, die Details hinter den Techniken und Werkzeugen zu verstehen.</p>
<p>Aus diesem Grund werden wir in diesem Blogbeitrag untersuchen, wie Mimikatz Anmeldeinformationen aus LSASS-Dumps extrahiert und wie wir diese Logik in ein Tool integrieren können, das auf unsere zukünftigen Bedürfnisse zugeschnitten ist.</p>
<p><strong>Hinweis</strong>: Alle Analysen, die im Rahmen dieses Projekts durchgeführt wurden, basieren auf einer Windows 11 Enterprise Evaluation-Workstation.</p>
<h2 id="warum-lsass">Warum LSASS?</h2>
<p>Bevor wir in die technischen Details eintauchen, ist es wichtig, die Frage zu stellen: Warum tun wir das?</p>
<p>Wenn ein Hacker Zugriff auf eine Zielmaschine mit Windows erhält, besteht einer der entscheidenden ersten Schritte darin, Anmeldeinformationen zu erlangen. Windows bietet mehrere potenzielle Ziele, aber zwei Hauptquellen stechen hervor: die lokale Sicherheitsdatenbank (Security Account Manager) und der LSASS-Prozess (Local Security Authority Subsystem Service).</p>
<p>In diesem Beitrag konzentrieren wir uns auf LSASS, das als zentrales Element in Windows fungiert und die Authentifizierung überwacht. Als zentrale Anlaufstelle für Authentifizierungsanforderungen verschiedener Dienste spielt es eine entscheidende Rolle bei der Optimierung des Authentifizierungsflusses. Dieser Prozess implementiert verschiedene Authentifizierungspakete wie NTLM, Kerberos, WDigest und andere. Folglich ist es ein wertvolles und informationsreiches Ziel für Hacker.</p>
<h2 id="ntlm-hashes">NTLM-Hashes</h2>
<p>Wie wir im vorherigen Abschnitt gesehen haben, verwaltet LSASS mehrere Authentifizierungspakete, darunter NTLM. NTLM ist ein Challenge-Response-Authentifizierungsprotokoll, das in Windows-Umgebungen weit verbreitet ist. Wenn sich ein Benutzer bei einem Windows-Rechner anmeldet, speichert das System die Anmeldeinformationen des Benutzers im Speicher. Diese Informationen beinhalten das Passwort des Benutzers in Form eines NTLM-Hashes.</p>
<p>In diesem Beitrag konzentrieren wir uns darauf, diese NTLM-Hashes aus dem LSASS-Prozess zu extrahieren, um die zugrunde liegende Logik besser zu verstehen.</p>
<p>Im folgenden Bild sehen wir die interne LSASS-Struktur, die hervorhebt, wo die NTLM-Hashes gespeichert sind.</p>
<p><img alt="lsass" src="/posts/lsass-extractor/static/lsass-structure.png"></p>
<h2 id="wo-befinden-sich-die-einzelnen-teile">Wo befinden sich die einzelnen Teile?</h2>
<p>Zu Beginn ist es wichtig zu verstehen, wo die Informationen gespeichert sind und in welchem Format. Der LSASS-Prozess ist ein kritischer Bestandteil, und nicht alle Informationen werden im Klartext gespeichert. In diesem Fall sind die NTLM-Hashes verschlüsselt. Um sie zu extrahieren, müssen wir die Schlüssel zur Entschlüsselung finden. Das folgende Diagramm veranschaulicht, welche Module an der Verwaltung der Schlüssel und der Anmeldeinformationen beteiligt sind.</p>
<!-- raw HTML omitted -->
<p>Es ist wichtig zu beachten, dass das kryptografische Material des LSASS-Prozesses Laufzeitdaten sind, die sich nach jedem Neustart ändern. Daher müssen wir sie jedes Mal extrahieren, um aktuelle Informationen zu erhalten.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>&#34;Es ist interessant zu beachten, dass das Verschlüsselungsmanagement über LsaProtectMemory erfolgt, das ein Wrapper für LsaEncryptMemory ist, das wiederum ein Wrapper für BCryptEncrypt ist, eine gängige Verschlüsselungsfunktion, die in bcrypt.h vorhanden ist.&#34;
</span></span></code></pre></div><h2 id="modultemplates">Modultemplates</h2>
<p>An diesem Punkt haben wir ein klares Verständnis davon, in welchem Bereich des Speichers sich alle Teile befinden. Jetzt müssen wir einen Weg finden, sie zu extrahieren. Durch die Analyse des Codes von PyPyKatz, einer Python-Version von Mimikatz, können wir den Ansatz verstehen, der verwendet wird, um die Schlüssel und Anmeldeinformationen zu extrahieren.</p>
<p>Zunächst müssen wir einige Informationen über das System extrahieren: ProcessorArchitecture, BuildNumber und aus dem &ldquo;ModuleListStream&rdquo; den TimeDateStamp von &ldquo;lsasrv.dll&rdquo;.</p>
<p>Sobald wir diese Informationen haben, können wir sie verwenden, um die richtige Vorlage zur Extraktion zu identifizieren. Die Templates sind Klassen, die die Signatur und die Offsets enthalten, die uns ermöglichen, uns im Speicher zu orientieren, um die Schlüssel und Anmeldeinformationen zu extrahieren.</p>
<p>In unserem Fall, einer Windows 11 Enterprise Evaluation, lautet die Vorlage für den lsasrv.dll-Teil wie folgt:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LSA_x64_6</span>(LsaTemplate_NT6):
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>		LsaTemplate_NT6<span style="color:#f92672">.</span>__init__(self)
</span></span><span style="display:flex;"><span>		self<span style="color:#f92672">.</span>key_pattern <span style="color:#f92672">=</span> LSADecyptorKeyPattern()
</span></span><span style="display:flex;"><span>		self<span style="color:#f92672">.</span>key_pattern<span style="color:#f92672">.</span>signature <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x83\x64\x24\x30\x00\x48\x8d\x45\xe0\x44\x8b\x4d\xd8\x48\x8d\x15</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>		self<span style="color:#f92672">.</span>key_pattern<span style="color:#f92672">.</span>IV_length <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>
</span></span><span style="display:flex;"><span>		self<span style="color:#f92672">.</span>key_pattern<span style="color:#f92672">.</span>offset_to_IV_ptr <span style="color:#f92672">=</span> <span style="color:#ae81ff">67</span>
</span></span><span style="display:flex;"><span>		self<span style="color:#f92672">.</span>key_pattern<span style="color:#f92672">.</span>offset_to_DES_key_ptr <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span>		self<span style="color:#f92672">.</span>key_pattern<span style="color:#f92672">.</span>offset_to_AES_key_ptr <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>
</span></span><span style="display:flex;"><span>				
</span></span><span style="display:flex;"><span>		self<span style="color:#f92672">.</span>key_struct <span style="color:#f92672">=</span> KIWI_BCRYPT_KEY81
</span></span><span style="display:flex;"><span>		self<span style="color:#f92672">.</span>key_handle_struct <span style="color:#f92672">=</span> KIWI_BCRYPT_HANDLE_KEY
</span></span></code></pre></div><p>Werfen Sie einen Blick auf den <a href="https://github.com/skelsec/pypykatz/blob/c91dcdc09289ad2e93c475e7c640d0f90906a7c0/pypykatz/lsadecryptor/lsa_template_nt6.py#L301">Quellcode</a> von PyPyKatz, um alle Vorlagen zu sehen.</p>
<h2 id="initialisierungsvektor-extraktion">Initialisierungsvektor-Extraktion</h2>
<p>Um die Schlüssel zu extrahieren, müssen wir zuerst den Initialisierungsvektor (IV) extrahieren. Der IV ist eine Zufallszahl, die sicherstellt, dass dieselbe Klartextnachricht nicht zum selben Chiffretext führt. Der IV wird im Speicher gespeichert, und wir können ihn extrahieren, indem wir im Speicher des Moduls lsasrv.dll nach dem im Template vorhandenen Muster suchen.</p>
<p>Sobald wir den Standort des Musters haben, können wir die Offsets verwenden, um uns im Speicher zu bewegen und den IV zu extrahieren.</p>
<!-- raw HTML omitted -->
<p>Wie im Schema zu sehen ist, müssen wir, nachdem wir den Standort des Musters haben, einen vordefinierten Offset (im Template vorhanden) von 67 Bytes überspringen, um einen weiteren Wert zu finden, der ein weiterer Offset ist. Dieser Offset ist der Standort des IV.</p>
<h2 id="schlüssel-extraktion">Schlüssel-Extraktion</h2>
<p>Nun ist es an der Zeit, die Schlüssel zu extrahieren. Der Ansatz ist ähnlich wie bei der Extraktion des IV. Wir müssen dasselbe Muster im Speicher finden und dann die Offsets verwenden, um die Schlüssel zu extrahieren.</p>
<!-- raw HTML omitted -->
<p>Dieses Mal führt uns der Zeiger nicht direkt zum gewünschten Wert, sondern zu einer BCRYPT_KEY_HANDLE-Struktur, die in bcrypt.h ein Datentyp ist, der das Referenzieren und Verwalten kryptografischer Schlüssel innerhalb des CNG-Frameworks ermöglicht. In pypykatz repliziert die Klasse KIWI_BCRYPT_HANDLE_KEY diesen Typ.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">KIWI_BCRYPT_HANDLE_KEY</span> :
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__ ( self , reader ) :
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>size <span style="color:#f92672">=</span> ULONG( reader )<span style="color:#f92672">.</span>value
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>tag <span style="color:#f92672">=</span> reader<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">4</span>) <span style="color:#75715e">#&#39;UUUR&#39;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>hAlgorithm <span style="color:#f92672">=</span> PVOID(reader)<span style="color:#f92672">.</span>value
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>ptr_key <span style="color:#f92672">=</span> PKIWI_BCRYPT_KEY(reader)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>unk0 <span style="color:#f92672">=</span> PVOID (reader)<span style="color:#f92672">.</span>value
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">...</span>]
</span></span></code></pre></div><p>An diesem Punkt haben wir alle notwendigen Informationen, um die NTLM-Hashes zu entschlüsseln. Wir haben den IV und die Schlüssel. Jetzt können wir mit der Suche nach den LogonSessions beginnen.</p>
<h2 id="logonsessions">LogonSessions</h2>
<p>Die LogonSessions sind die Strukturen, die die Informationen über die Benutzer enthalten, die im System angemeldet sind. Die LogonSessions werden im Speicher des Moduls Msv1_0.dll gespeichert, und wir können sie extrahieren, indem wir nach dem im spezifischen Template vorhandenen Muster suchen, das in unserem Fall wie folgt aussieht:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">elif</span> WindowsBuild<span style="color:#f92672">.</span>WIN_11_2022<span style="color:#f92672">.</span>value <span style="color:#f92672">&lt;=</span> sysinfo<span style="color:#f92672">.</span>buildnumber <span style="color:#f92672">&lt;</span> WindowsBuild<span style="color:#f92672">.</span>WIN_11_2023<span style="color:#f92672">.</span>value: <span style="color:#75715e">#20348</span>
</span></span><span style="display:flex;"><span>    template<span style="color:#f92672">.</span>signature <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x45\x89\x34\x24\x4c\x8b\xff\x8b\xf3\x45\x85\xc0\x74</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>    template<span style="color:#f92672">.</span>first_entry_offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">24</span>
</span></span><span style="display:flex;"><span>    template<span style="color:#f92672">.</span>offset2 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>
</span></span></code></pre></div><p>Es ist nicht möglich, die genaue Anzahl der im Speicher vorhandenen LogonSessions zu kennen, daher müssen wir zuerst den Zähler abrufen.</p>
<h4 id="logonsessions-zähler-und-adressen">LogonSessions-Zähler und Adressen</h4>
<p>Mit einem ähnlichen Ansatz wie bei der Extr</p>
<p>aktion des IV und der Schlüssel müssen wir das Muster im Speicher finden und dann die Offsets verwenden, um den Zähler zu extrahieren.</p>
<p>Dieser Zähler ermöglicht es uns, alle LogonSessions-Adressen durchzugehen, wobei jeder Eintrag 16 Bytes neben dem vorherigen liegt.</p>
<!-- raw HTML omitted -->
<p>Durch das Umwandeln dieser Adressen in einen char*-Pointer wird es zu einem Zeiger, der auf die Speicheradresse zeigt, an der die LogonSessions-Einträge gespeichert sind. Dies ermöglicht den Zugriff auf die mit der LogonSession verbundenen Daten und damit das Abrufen relevanter Informationen.</p>
<h4 id="benutzername-und-domäne">Benutzername und Domäne</h4>
<p>Jetzt, da wir die Adressen der LogonSessions haben, können wir mit der Extraktion der Informationen beginnen. Durch einen Sprung von 144 Bytes von der Adresse aus befinden sich mehrere Felder, darunter die Länge des Benutzernamens, die maximale Länge und ein Zeiger auf den tatsächlichen Benutzernamen.
Die gleiche Logik gilt für die Domäne, die im Speicher nach dem Zeiger auf den Benutzernamen gespeichert ist.</p>
<p>Nun ist es möglich, den Benutzernamen und die Domäne des Benutzers zu extrahieren, indem man den Zeigern folgt und die genaue Anzahl der Bytes liest, die im Feld der maximalen Länge gespeichert sind.</p>
<!-- raw HTML omitted -->
<h4 id="anmeldeinformationen-liste">Anmeldeinformationen-Liste</h4>
<p>Für den letzten Teil der Extraktion müssen wir uns auf die Liste der Anmeldeinformationen konzentrieren. Ausgehend vom pointerToDomain, den wir im vorherigen Abschnitt gesehen haben, können wir durch einen weiteren Sprung von 96 Bytes die Speicheradresse finden, an der die erste &lsquo;Anmeldeinformationen-Liste&rsquo; gespeichert ist. Sobald der Wert an der angegebenen Adresse als uint64_t gelesen und als Speicheradresse interpretiert wird, erhalten wir die Speicheradresse der zweiten &lsquo;Anmeldeinformationen-Liste&rsquo;, und dieser Prozess setzt sich iterativ fort. Da es sich um eine zirkuläre verkettete Liste handelt, zeigt die Übereinstimmung des Werts mit der Speicheradresse der ersten Struktur an, dass die gesamte Liste durchlaufen wurde.</p>
<p>Jeder Eintrag in der verketteten Liste der &lsquo;Anmeldeinformationen-Liste&rsquo; enthält seine eigene verkettete Liste, die als &lsquo;Primäre Anmeldeinformationen-Liste&rsquo; bezeichnet wird. Um die Adresse des ersten Eintrags in dieser verketteten Liste abzurufen, muss ein Offset von 16 Bytes vorangeschritten und dieser Speicherbereich als char*-Pointer gelesen werden.</p>
<p>Das folgende Schema veranschaulicht die Struktur der Listen:
<!-- raw HTML omitted --></p>
<p>In dieser letzten Struktur kann der verschlüsselte NTLM-Hash gefunden werden. Ähnlich wie bei der verketteten Liste der &lsquo;Anmeldeinformationen-Liste&rsquo; führt die Interpretation der Zahl an der Adresse des ersten Eintrags der Primären Anmeldeinformationen-Liste als Adresse zur Entdeckung der nächsten Struktur, wobei eine zirkuläre Liste verfolgt wird. Durch das Befolgen der Struktur ist es möglich, die Größe des verschlüsselten NTLM-Hashes und die Speicheradresse, an der sich dieser NTLM befindet, zu ermitteln, um ihn anschließend zu lesen und zu extrahieren.</p>
<h2 id="ntlm-entschlüsselung">NTLM-Entschlüsselung</h2>
<p>Der Verschlüsselungsalgorithmus, der zum Verschlüsseln des Hashs verwendet wird, kann im Voraus nicht bestimmt werden. Um den Algorithmus zu identifizieren, wird der verschlüsselte NTLM durch 8 geteilt, und der Rest wird überprüft, um festzustellen, ob die Länge des NTLM durch 8 teilbar ist. Wenn die Länge des NTLM durch 8 teilbar ist, wird AES-Verschlüsselung verwendet. Wenn die Länge des NTLM nicht durch 8 teilbar ist, was auf eine unregelmäßige Länge hinweist, wird 3DES-Verschlüsselung verwendet.</p>
<p>Der folgende Pseudocode stellt die Logik der Algorithmusauswahl dar:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ( encryptedNTLMLength <span style="color:#f92672">%</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span> <span style="color:#75715e">// Verschlüsselte Anmeldeinformationen waren leer?
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span> <span style="color:#75715e">// Algorithmusfunktionen und IV vorbereiten
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> <span style="color:#66d9ef">if</span> ( encryptedNTLMLength <span style="color:#f92672">%</span> <span style="color:#ae81ff">8</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// AES-Entschlüsselung mit dem bereitgestellten Schlüssel durchführen
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 3DES-Entschlüsselung mit dem bereitgestellten Schlüssel durchführen
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Sobald der verwendete Algorithmus identifiziert wurde, besteht die verbleibende Aufgabe darin, die gewonnenen Informationen mit der bcrypt.h-Bibliothek anzuwenden, indem der gleiche Ansatz wie MSV verfolgt wird. Durch die Konfiguration der erforderlichen Variablen zur Verwendung des richtigen Algorithmus und anschließendem Aufrufen der BCrypt-Decrypt-Funktion mit dem verschlüsselten Schlüssel und dem wiederhergestellten IV wird es möglich, den NTLM-Hash im Klartext abzurufen.</p>

                                            </div>
                                        </div>
                                        <ul class="blog-tags"> 
                                            
                                            
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    
    <div class="preloader preloader-alt no-split">
        <span class="spinner spinner-alt">
            <img class="spinner-brand" src="/images/logo-white.png" alt=""> 
        </span>
    </div>
    





<script defer  src='/js/jquery.bundle.min.5982afc908c46b2144b576a651c29adc72bf2dfa9685a00c7dd16b77aba777a4d1c66ba9fe480a81bc42cc40879d8d16d3660e1ff7e0b6e9ca1f4b78d11ebbab.js?ver=210'></script>
<script defer  src='/js/scripts.min.810c4e3229f07102e6da786e19bada1559816724bfcb53aaffc206384b0935134d42df8a0048ea62bbe01e23993b85f12897baf4e45862d5e767c65a878cbd61.js?ver=210'></script>
<script defer  src='/js/charts.min.233bec70385379d36087ce327911a0880e9f24394a47f3ac96262f2ab5ec6e6abcd23516c1250b6b9686a39298686089a91247237a53dfcdc082554f810b8cad.js?ver=210'></script>
<script defer  src='/js/toastr.examples.min.8db0f69b90e47bd433705b43acc2ffcc16aeaa78f06edd02fdc97e67abad460d09fe0135f2e92bc5b30ad986d87467ca3e33d470592d4c1d181554fdd8791fc6.js?ver=210'></script>
<section id="footer">
    <footer class="nk-footer bg-theme-dark">
        <div class="tc-light">
            <div class="container">
                <div class="nk-block">
                    <div class="bg-theme-accent-alt round subscribe-wrap animated" data-animate="fadeInUp" data-delay=".1">
                        <div class="row text-center text-md-start justify-content-center align-items-center gutter-vr-25px">
                            <div class="col-lg-6">
                                <div class="wide-auto-sm">
                                    <h4 class="title-sm">Bleiben Sie auf dem Laufenden</h4>
                                    <p>Abonnieren Sie unseren Newsletter und erhalten Sie Updates und Marktnachrichten. Erhalten Sie Neuigkeiten zu TeamFence.</p>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="gap-3x d-none d-lg-block"></div>
                                <form action="https://formspree.io/f/meojgrqj" class="nk-form-submit" method="post">
                                    <div class="field-inline field-inline-s2 field-inline-s2-sm bg-white shadow-soft">
                                        <div class="field-wrap">
                                            <input class="input-solid input-solid-md required email" type="email" name="email" placeholder="Your email" required>
                                            <input type="text" class="d-none" name="_gotcha" style="display:none">
                                        </div>
                                        <div class="submit-wrap">
                                            <button type="submit" class="btn btn-md btn-grad">Abonnieren</button>
                                        </div>
                                    </div>
                                    <div class="form-results" id="form-results" style="display: none;"></div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="space-to-color-2" class="nk-ovm ovm-top ovm-h-50 bg-theme-alt"></div>
        </div>
        <div class="section section-footer section-m tc-light bg-transparent ov-h">
            <div class="container">
                <div class="nk-block block-footer">
                    <div class="row">
                        <div class="col">
                            <div class="wgs wgs-text text-center mb-3">
                                <ul class="social pdb-l justify-content-center">
                                    <li><a href="#"><em class="social-icon fab fa-facebook-f"></em></a></li>
                                    <li><a href="#"><em class="social-icon fab fa-twitter"></em></a></li>
                                    <li><a href="#"><em class="social-icon fab fa-youtube"></em></a></li>
                                    <li><a href="#"><em class="social-icon fab fa-github"></em></a></li>
                                    <li><a href="#"><em class="social-icon fab fa-bitcoin"></em></a></li>
                                    <li><a href="#"><em class="social-icon fab fa-medium-m"></em></a></li>
                                </ul>
                                <a href="./" class="footer-logo">
                                    <img src="/images/logo-white.png" srcset="/images/logo-white.png" alt="logo" style="width: 25%">
                                </a>
                                <div class="copyright-text copyright-text-s3 pdt-m">
                                    <p><span class="d-sm-block">Copyright © 2024, TeamFence sagl CHE-197.469.909<br>Viale Castagnola 27, 6900 Lugano</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="nk-ovm shape-s"></div>
        </div>
    </footer>
</section>
</div>
</body>
</html>